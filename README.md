以下に、GAS関数`calculateSalary`のREADMEを日本語で作成しました。

---

# calculateSalary GAS関数

このGoogle Apps Script (GAS) 関数は、カレンダーイベントに基づいて給与計算を自動化します。設定シートから時給、深夜時給、交通費、イベント名を取得し、指定されたイベント名を含むカレンダーイベントを基に、各月の給与を計算し、スプレッドシートに出力します。

## 目次

- [セットアップ](#セットアップ)
- [関数の概要](#関数の概要)
- [詳細な処理](#詳細な処理)
- [出力](#出力)

## セットアップ

1. **スプレッドシートの準備**:
   - 以下のシートを含むGoogleスプレッドシートを作成します:
     - `設定`: 時給、深夜時給、交通費、イベント名などの設定を格納するシート。
     - `Template`: 年度別給与シートのテンプレートとして使用するシート。

2. **設定シート (`設定`)**:
   - セル `B2`: 通常の時給。
   - セル `B3`: 深夜時給。
   - セル `B4`: 交通費（日額）。
   - セル `B5`: アルバイトのイベント名。

3. **テンプレートシート (`Template`)**:
   - 給与シートのテンプレートを適切な列（例：`A1`セルに年、`B`列に給与、`C`列に勤務時間、`D`列に深夜勤務時間、`E`列に勤務日数）を設定して準備します。

## 関数の概要

`calculateSalary`関数は、以下のタスクを実行します:
1. `設定`シートから設定情報を取得します。
2. 指定されたイベント名を含むカレンダーイベントを定義された期間内で取得します。
3. イベントを年と月ごとに分類します。
4. 各年の給与シートを準備します。
5. 各月の給与、勤務時間、深夜勤務時間、勤務日数を計算します。
6. 計算結果を対応するシートに出力します。

## 詳細な処理

1. **設定情報の取得**:
   - `設定`シートから時給、深夜時給、交通費、イベント名を取得します。

2. **カレンダーイベントの取得**:
   - 2020年1月1日から翌月末までの期間で、指定されたイベント名を含むデフォルトカレンダーのイベントを取得します。

3. **イベントの分類**:
   - イベントを年ごとおよび月ごとに分類します。

4. **給与シートの準備**:
   - 各年に対応する給与シートが存在しない場合、`Template`シートをコピーして新しいシートを作成し、該当年にリネームします。

5. **給与の計算**:
   - 各月ごとに以下を計算します:
     - **通常勤務時間**: 通常の勤務時間の合計。
     - **深夜勤務時間**: 深夜勤務時間（22時から5時まで）の合計。
     - **勤務日数**: 勤務日の合計数。
     - **休憩時間**: イベントの説明から取得した休憩時間の合計。
     - **給与合計**: 以下の計算式を使用:
       \[
       \text{給与合計} = (\text{通常勤務時間} - \text{休憩時間}) \times \text{時給} + \text{深夜勤務時間} \times \text{深夜時給} + \text{勤務日数} \times \text{交通費}
       \]

6. **計算結果の出力**:
   - 計算結果を各年の給与シートの対応する列に出力します (`B`列に給与、`C`列に勤務時間、`D`列に深夜勤務時間、`E`列に勤務日数)。

## 出力

関数は以下のデータを各年の給与シートに出力します:
- **月別給与** (`B`列)
- **月別勤務時間** (`C`列)
- **月別深夜勤務時間** (`D`列)
- **月別勤務日数** (`E`列)
